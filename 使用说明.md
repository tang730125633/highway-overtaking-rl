# é«˜é€Ÿå…¬è·¯è¶…è½¦RLç³»ç»Ÿ - ä½¿ç”¨è¯´æ˜

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Windows 10/11ï¼ˆæ¨èï¼‰ã€macOSã€Linux
- **Pythonç‰ˆæœ¬**: 3.8 - 3.10ï¼ˆâš ï¸ ä¸è¦ä½¿ç”¨3.14ï¼‰
- **å†…å­˜**: å»ºè®® â‰¥8GB
- **ç¡¬ç›˜**: â‰¥2GB ç©ºé—²ç©ºé—´

## ğŸŒ æ–¹å¼ä¸€ï¼šWebå¯è§†åŒ–ç•Œé¢ï¼ˆæœ€ç®€å•ï¼Œå¼ºçƒˆæ¨èï¼ï¼‰

**é€‚åˆäººç¾¤**ï¼šä¸æƒ³ç”¨å‘½ä»¤è¡Œçš„ç”¨æˆ·ã€éœ€è¦åˆ†äº«æ¼”ç¤ºçš„åœºæ™¯

### æœ¬åœ°å¯åŠ¨

**Windowsç”¨æˆ·**ï¼š
```
åŒå‡»è¿è¡Œ start_app.bat
```

**Macç”¨æˆ·**ï¼š
```
åŒå‡»è¿è¡Œ start_app.command
```

**æˆ–å‘½ä»¤è¡Œè¿è¡Œ**ï¼š
```bash
python -m streamlit run app.py
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ï¼š`http://localhost:8501`

### äº‘ç«¯éƒ¨ç½²ï¼ˆå…è´¹åˆ†äº«ï¼‰

å®Œå…¨å…è´¹éƒ¨ç½²åˆ°ç½‘ä¸Šï¼Œè·å¾—ä¸€ä¸ªæ°¸ä¹…é“¾æ¥ï¼Œå®¢æˆ·å¯ç›´æ¥è®¿é—®ï¼š

1. ä¸Šä¼ ä»£ç åˆ°GitHub
2. è®¿é—® https://share.streamlit.io/
3. ç™»å½•GitHubæˆæƒ
4. é€‰æ‹©ä»“åº“ï¼Œç‚¹å‡»"Deploy"
5. è·å¾—é“¾æ¥ï¼š`https://your-app.streamlit.app`

**è¯¦ç»†éƒ¨ç½²æ•™ç¨‹**ï¼šæŸ¥çœ‹ `DEPLOYMENT.md`

### Webç•Œé¢åŠŸèƒ½

âœ… **é¡¹ç›®Dashboard** - æŸ¥çœ‹æ•´ä½“çŠ¶æ€å’Œæ€§èƒ½å¯¹æ¯”
âœ… **äº¤äº’å¼è¯„æµ‹** - é€‰æ‹©æ–¹æ³•/å¯†åº¦/ç§å­ï¼Œä¸€é”®è¿è¡Œ
âœ… **ç»“æœå¯è§†åŒ–** - è‡ªåŠ¨ç”Ÿæˆå›¾è¡¨ã€å¯¹æ¯”åˆ†æ
âœ… **æŸ¥çœ‹ç»“æœ** - æµè§ˆæ‰€æœ‰è¯„æµ‹æ•°æ®
âœ… **è®ºæ–‡å›¾è¡¨** - æŸ¥çœ‹å’Œä¸‹è½½ç”Ÿæˆçš„PNGå›¾è¡¨

---

## ğŸš€ æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œæ–¹å¼ï¼ˆæ¨èæ–¹å¼ï¼‰

### ä¸€é”®è¿è¡Œå®Œæ•´æµç¨‹

åŒå‡»è¿è¡Œ `quick_start.bat`ï¼Œå°†è‡ªåŠ¨å®Œæˆï¼š

1. âœ… å®‰è£…æ‰€æœ‰ä¾èµ–
2. âœ… æµ‹è¯•ç¯å¢ƒ
3. âœ… è®­ç»ƒPPOæ¨¡å‹
4. âœ… è¿è¡Œæ‰€æœ‰è¯„æµ‹ï¼ˆBaselineã€RLã€RL+Safetyï¼‰
5. âœ… ç”Ÿæˆè®ºæ–‡å›¾è¡¨

**é¢„è®¡æ€»è€—æ—¶**: 30-60åˆ†é’Ÿï¼ˆå–å†³äºç”µè„‘æ€§èƒ½ï¼‰

---

## ğŸ”§ åˆ†æ­¥æ‰§è¡Œï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

### æ­¥éª¤1: ç¯å¢ƒå®‰è£…

```bash
åŒå‡»è¿è¡Œ: setup.bat
```

æˆ–åœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š

```bash
setup.bat
```

### æ­¥éª¤2: æµ‹è¯•ç¯å¢ƒ

```bash
scripts\0_test_env.bat
```

å¦‚æœçœ‹åˆ°"âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡"ï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æˆåŠŸã€‚

### æ­¥éª¤3: è®­ç»ƒPPOæ¨¡å‹

```bash
scripts\1_train_ppo.bat
```

**è®­ç»ƒæ—¶é•¿**: 20-40åˆ†é’Ÿï¼ˆå–å†³äºç”µè„‘æ€§èƒ½ï¼‰

**è¾“å‡º**:
- æ¨¡å‹æ–‡ä»¶: `outputs/models/best/best_model.zip`
- è®­ç»ƒæ—¥å¿—: `outputs/logs/`

**å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹**ï¼ˆå¯é€‰ï¼‰:

```bash
tensorboard --logdir outputs/logs
```

ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost:6006

### æ­¥éª¤4: è¿è¡Œè¯„æµ‹

#### 4.1 è¯„æµ‹åŸºçº¿ç­–ç•¥

```bash
scripts\2_eval_baseline.bat
```

#### 4.2 è¯„æµ‹RLç­–ç•¥

```bash
scripts\3_eval_rl.bat
```

#### 4.3 è¯„æµ‹RL+Safetyç­–ç•¥

```bash
scripts\4_eval_rl_safety.bat
```

### æ­¥éª¤5: ç”Ÿæˆè®ºæ–‡å›¾è¡¨

```bash
scripts\5_generate_plots.bat
```

**è¾“å‡º**:
- å›¾è¡¨: `outputs/figures/`
- æ•°æ®: `outputs/results/`

---

## ğŸ“Š ç»“æœæ–‡ä»¶è¯´æ˜

### 1. è®­ç»ƒæ¨¡å‹

ä½ç½®: `outputs/models/`

- `best/best_model.zip` - è¯„ä¼°æœ€ä½³æ¨¡å‹
- `ppo_highway_final.zip` - æœ€ç»ˆæ¨¡å‹
- `ppo_highway_*.zip` - è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ£€æŸ¥ç‚¹

### 2. è¯„æµ‹ç»“æœ

ä½ç½®: `outputs/results/`

æ¯ä¸ªè¯„æµ‹ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š

- `*_metrics_summary.json` - æ±‡æ€»æŒ‡æ ‡ï¼ˆæˆåŠŸç‡ã€ç¢°æ’ç‡ç­‰ï¼‰
- `*_episodes_detail.csv` - æ¯ä¸ªepisodeçš„è¯¦ç»†æ•°æ®

**æ–‡ä»¶å‘½åè§„åˆ™**:

```
{æ–¹æ³•}_{å¯†åº¦}_seed{ç§å­}_metrics_summary.json
```

ä¾‹å¦‚ï¼š
- `baseline_medium_seed42_metrics_summary.json` - åŸºçº¿ç­–ç•¥ï¼Œä¸­ç­‰å¯†åº¦ï¼Œç§å­42
- `rl_safety_high_seed123_metrics_summary.json` - RL+Safetyï¼Œé«˜å¯†åº¦ï¼Œç§å­123

### 3. è®ºæ–‡å›¾è¡¨

ä½ç½®: `outputs/figures/`

- `comparison_medium_density.png` - ä¸­ç­‰å¯†åº¦ä¸‹çš„æ–¹æ³•å¯¹æ¯”ï¼ˆ6ä¸ªå­å›¾ï¼‰
- `comparison_across_densities.png` - ä¸åŒå¯†åº¦ä¸‹çš„æ€§èƒ½å¯¹æ¯”ï¼ˆ3ä¸ªå­å›¾ï¼‰

---

## ğŸ¯ æ ¸å¿ƒæŒ‡æ ‡è¯´æ˜

æ‰€æœ‰è¯„æµ‹ä¼šè®¡ç®—ä»¥ä¸‹æ ¸å¿ƒæŒ‡æ ‡ï¼š

| æŒ‡æ ‡ | è¯´æ˜ | è®ºæ–‡ç« èŠ‚ |
|------|------|----------|
| **è¶…è½¦æˆåŠŸç‡** | æˆåŠŸå®Œæˆè¶…è½¦çš„æ¯”ä¾‹ | ç¬¬6ç«  |
| **ç¢°æ’ç‡** | å‘ç”Ÿç¢°æ’çš„æ¯”ä¾‹ | ç¬¬6ç«  |
| **è¿è§„ç‡** | å±é™©è·ç¦»ã€å±é™©æ¢é“çš„æ¯”ä¾‹ | ç¬¬6ç«  |
| **å¹³å‡é€Ÿåº¦** | Episodeå¹³å‡é€Ÿåº¦ï¼ˆkm/hï¼‰ | ç¬¬6ç«  |
| **å¹³å‡å¥–åŠ±** | Episodeå¹³å‡ç´¯è®¡å¥–åŠ± | ç¬¬4ç«  |
| **è¶…è½¦è€—æ—¶** | æˆåŠŸè¶…è½¦çš„å¹³å‡æ—¶é—´ï¼ˆæ­¥æ•°ï¼‰ | ç¬¬6ç«  |

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¯´æ˜

### ç¯å¢ƒé…ç½® (`configs/env_config.yaml`)

```yaml
# äº¤é€šå¯†åº¦ï¼ˆä¿®æ”¹è¿™é‡Œå¯ä»¥æ”¹å˜åœºæ™¯éš¾åº¦ï¼‰
traffic_density:
  low: 10       # ä½å¯†åº¦ï¼š10è¾†è½¦
  medium: 20    # ä¸­å¯†åº¦ï¼š20è¾†è½¦
  high: 30      # é«˜å¯†åº¦ï¼š30è¾†è½¦

# å®‰å…¨çº¦æŸ
safety:
  min_safe_distance: 15.0  # æœ€å°å®‰å…¨è·ç¦»ï¼ˆç±³ï¼‰
  min_time_headway: 1.5    # æœ€å°æ—¶é—´å¤´è·ï¼ˆç§’ï¼‰
```

### è®­ç»ƒé…ç½® (`configs/train_config.yaml`)

```yaml
# è®­ç»ƒæ­¥æ•°ï¼ˆå‡å°‘å¯ä»¥åŠ å¿«è®­ç»ƒï¼Œä½†å¯èƒ½å½±å“æ€§èƒ½ï¼‰
total_timesteps: 100000

# å¹¶è¡Œç¯å¢ƒæ•°ï¼ˆæ ¹æ®ç”µè„‘æ€§èƒ½è°ƒæ•´ï¼‰
n_envs: 4

# PPOè¶…å‚æ•°
ppo:
  learning_rate: 0.0003
  gamma: 0.99
```

### è¯„æµ‹é…ç½® (`configs/eval_config.yaml`)

```yaml
# æ¯ä¸ªåœºæ™¯çš„è¯„æµ‹è½®æ•°ï¼ˆå‡å°‘å¯ä»¥åŠ å¿«è¯„æµ‹ï¼‰
n_eval_episodes: 50

# è¯„æµ‹åœºæ™¯
scenarios:
  traffic_densities: ["low", "medium", "high"]
  seeds: [42, 123, 456]
```

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. å®‰è£…å¤±è´¥ï¼šæ‰¾ä¸åˆ°Python

**è§£å†³æ–¹æ³•**:
1. ç¡®è®¤å·²å®‰è£…Python 3.8-3.10
2. ç¡®è®¤Pythonåœ¨ç³»ç»ŸPATHä¸­
3. åœ¨å‘½ä»¤è¡Œè¿è¡Œ `python --version` éªŒè¯

### 2. è®­ç»ƒå¾ˆæ…¢

**è§£å†³æ–¹æ³•**:
1. å‡å°‘ `train_config.yaml` ä¸­çš„ `total_timesteps`ï¼ˆå¦‚æ”¹ä¸º50000ï¼‰
2. å‡å°‘ `n_envs`ï¼ˆå¦‚æ”¹ä¸º2ï¼‰

### 3. è¯„æµ‹ç»“æœä¸ç†æƒ³

**å¯èƒ½åŸå› **:
- è®­ç»ƒæ­¥æ•°ä¸è¶³ â†’ å¢åŠ  `total_timesteps`
- éšæœºç§å­å½±å“ â†’ å¤šè¯•å‡ ä¸ªç§å­
- è¶…å‚æ•°ä¸åˆé€‚ â†’ è°ƒæ•´å­¦ä¹ ç‡ç­‰å‚æ•°

### 4. æ‰¾ä¸åˆ°æ¨¡å‹æ–‡ä»¶

**è§£å†³æ–¹æ³•**:
- ç¡®è®¤å·²è¿è¡Œ `1_train_ppo.bat` å®Œæˆè®­ç»ƒ
- æ£€æŸ¥ `outputs/models/best/` ç›®å½•æ˜¯å¦å­˜åœ¨ `best_model.zip`

### 5. å›¾è¡¨ä¸­æ–‡ä¹±ç 

**è§£å†³æ–¹æ³•**:
- Windows: ç¡®ä¿ç³»ç»Ÿå·²å®‰è£…ä¸­æ–‡å­—ä½“
- æˆ–ä¿®æ”¹ `src/utils/visualize.py` ä¸­çš„å­—ä½“è®¾ç½®

---

## ğŸ“ è®ºæ–‡æ’°å†™å»ºè®®

### ç¬¬2ç« ï¼šç¯å¢ƒè®¾è®¡

å¼•ç”¨å†…å®¹ï¼š
- `configs/env_config.yaml` - ç¯å¢ƒå‚æ•°è®¾ç½®
- `src/env/overtaking_env.py` - MDPå»ºæ¨¡ä»£ç 

### ç¬¬3ç« ï¼šåŸºçº¿æ–¹æ³•

å¼•ç”¨å†…å®¹ï¼š
- `src/baseline/rule_based.py` - åŸºçº¿ç­–ç•¥ä»£ç 
- å‚æ•°è¡¨ï¼ˆä»ä»£ç ä¸­æå–ï¼‰

### ç¬¬4ç« ï¼šRLç®—æ³•

å¼•ç”¨å†…å®¹ï¼š
- `configs/train_config.yaml` - PPOè¶…å‚æ•°
- `outputs/logs/` - è®­ç»ƒæ—¥å¿—ï¼ˆTensorBoardï¼‰

### ç¬¬5ç« ï¼šå®‰å…¨çº¦æŸ

å¼•ç”¨å†…å®¹ï¼š
- `src/rl/safety_shield.py` - Safety Shieldä»£ç 
- è¯„æµ‹ç»“æœä¸­çš„å¹²é¢„ç»Ÿè®¡

### ç¬¬6ç« ï¼šå®éªŒç»“æœ

å¼•ç”¨å†…å®¹ï¼š
- `outputs/results/` - æ‰€æœ‰è¯„æµ‹æ•°æ®
- `outputs/figures/` - å¯¹æ¯”å›¾è¡¨

---

## ğŸ’¡ æ¼”ç¤ºå»ºè®®

### ç°åœºæ¼”ç¤ºæ­¥éª¤

1. **å‡†å¤‡å·¥ä½œ**:
   - æå‰è¿è¡Œ `quick_start.bat` å®Œæˆè®­ç»ƒå’Œè¯„æµ‹
   - å‡†å¤‡å¥½ `outputs/figures/` ä¸­çš„å›¾è¡¨

2. **æ¼”ç¤ºæµç¨‹**:
   ```bash
   # 1. æµ‹è¯•ç¯å¢ƒï¼ˆå±•ç¤ºç¯å¢ƒæ­£å¸¸å·¥ä½œï¼‰
   scripts\0_test_env.bat

   # 2. å±•ç¤ºè®­ç»ƒæ—¥å¿—
   tensorboard --logdir outputs/logs

   # 3. è¿è¡Œä¸€æ¬¡è¯„æµ‹ï¼ˆå®æ—¶æ¼”ç¤ºï¼‰
   scripts\3_eval_rl.bat

   # 4. å±•ç¤ºç»“æœå›¾è¡¨
   ï¼ˆæ‰“å¼€ outputs/figures/ ä¸­çš„å›¾ç‰‡ï¼‰
   ```

3. **å…³é”®ç‚¹**:
   - å¼ºè°ƒä¸‰ç»„å¯¹æ¯”ï¼ˆBaseline vs RL vs RL+Safetyï¼‰
   - å¼ºè°ƒå¤šå¯†åº¦ã€å¤šç§å­çš„å®éªŒè®¾è®¡
   - å¼ºè°ƒSafety Shieldçš„æœ‰æ•ˆæ€§

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. `outputs/logs/` ä¸­çš„æ—¥å¿—æ–‡ä»¶
2. ç¡®è®¤Pythonç‰ˆæœ¬ä¸º3.8-3.10
3. ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²æ­£ç¡®å®‰è£…

---

**å¼€å‘æ—¥æœŸ**: 2026-02
**Pythonç‰ˆæœ¬**: 3.8-3.10
**ä¸»è¦ä¾èµ–**: highway-env, stable-baselines3, gymnasium
